.PHONY: help

help:
	@echo "Available targets:"
	@awk -F '[:=]' '\
		/^[a-zA-Z0-9_-]+:/ && !/^[.](PHONY|help):/ { \
			target = $$1; \
			if (!(target in titles)) { \
				titles[target] = "no title provided"; \
			} \
			order[++count] = target; \
		} \
		/^[a-zA-Z0-9_-]+[.]title[[:space:]]*=/ { \
			split($$1, parts, "."); \
			target = parts[1]; \
			titles[target] = $$2; \
			gsub(/^[ \t]+/, "", titles[target]); \
		} \
		END { \
			for (i = 1; i <= count; i++) { \
				target = order[i]; \
				printf "  %-15s %s\n", target, titles[target]; \
			} \
		}' Makefile
